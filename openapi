{"openapi":"3.1.0","info":{"title":"BookWeaver AI Backend","description":"Локальный сервер для выполнения тяжелых AI-задач.","version":"1.0.0"},"paths":{"/health":{"get":{"tags":["Health Check"],"summary":"Health Check","description":"Проверяет текущее состояние готовности сервера.","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServerStatus"}}}}}}},"/api/v1/tasks/{task_id}/status":{"get":{"tags":["Task Management"],"summary":"Get Task Status","description":"Возвращает статус и прогресс для фоновой задачи по её ID.","operationId":"get_task_status_api_v1_tasks__task_id__status_get","parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"string","title":"Task Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/projects/import":{"post":{"tags":["Projects & Files API"],"summary":"Import Project","description":"Загружает файл книги (.txt, .epub) и преобразует его в структуру проекта.","operationId":"import_project_api_v1_projects_import_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_import_project_api_v1_projects_import_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/projects/{book_name}/export":{"get":{"tags":["Projects & Files API"],"summary":"Export Project","description":"Собирает проект в портативный .bw архив и возвращает его для скачивания.","operationId":"export_project_api_v1_projects__book_name__export_get","parameters":[{"name":"book_name","in":"path","required":true,"schema":{"type":"string","title":"Book Name"}}],"responses":{"200":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/projects/":{"get":{"tags":["Projects & Files API"],"summary":"List Projects","description":"Сканирует директорию input/books и возвращает список всех книг (проектов).","operationId":"list_projects_api_v1_projects__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v1/projects/{book_name}":{"get":{"tags":["Projects & Files API"],"summary":"Get Project Details","description":"Возвращает детальную информацию о книге: список глав и статус их обработки.","operationId":"get_project_details_api_v1_projects__book_name__get","parameters":[{"name":"book_name","in":"path","required":true,"schema":{"type":"string","title":"Book Name"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/projects/{book_name}/artifacts/{artifact_name}":{"get":{"tags":["Projects & Files API"],"summary":"Get Book Artifact","description":"Возвращает содержимое артефакта уровня книги (например, manifest.json).","operationId":"get_book_artifact_api_v1_projects__book_name__artifacts__artifact_name__get","parameters":[{"name":"book_name","in":"path","required":true,"schema":{"type":"string","title":"Book Name"}},{"name":"artifact_name","in":"path","required":true,"schema":{"$ref":"#/components/schemas/BookArtifactName"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Projects & Files API"],"summary":"Update Book Artifact","description":"Обновляет (перезаписывает) артефакт уровня книги (например, manifest.json).\nПринимает JSON в теле запроса.","operationId":"update_book_artifact_api_v1_projects__book_name__artifacts__artifact_name__post","parameters":[{"name":"book_name","in":"path","required":true,"schema":{"type":"string","title":"Book Name"}},{"name":"artifact_name","in":"path","required":true,"schema":{"$ref":"#/components/schemas/BookArtifactName"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/projects/{book_name}/chapters/{volume_num}/{chapter_num}/artifacts/{artifact_name}":{"get":{"tags":["Projects & Files API"],"summary":"Get Chapter Artifact","description":"Возвращает содержимое артефакта уровня главы (например, scenario.json).","operationId":"get_chapter_artifact_api_v1_projects__book_name__chapters__volume_num___chapter_num__artifacts__artifact_name__get","parameters":[{"name":"book_name","in":"path","required":true,"schema":{"type":"string","title":"Book Name"}},{"name":"volume_num","in":"path","required":true,"schema":{"type":"integer","title":"Volume Num"}},{"name":"chapter_num","in":"path","required":true,"schema":{"type":"integer","title":"Chapter Num"}},{"name":"artifact_name","in":"path","required":true,"schema":{"$ref":"#/components/schemas/ChapterArtifactName"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/projects/{book_name}/cover":{"post":{"tags":["Projects & Files API"],"summary":"Upload Cover","description":"Загружает или обновляет обложку для проекта.","operationId":"upload_cover_api_v1_projects__book_name__cover_post","parameters":[{"name":"book_name","in":"path","required":true,"schema":{"type":"string","title":"Book Name"}}],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_cover_api_v1_projects__book_name__cover_post"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Projects & Files API"],"summary":"Get Cover","description":"Отдает файл обложки книги для отображения в клиенте.","operationId":"get_cover_api_v1_projects__book_name__cover_get","parameters":[{"name":"book_name","in":"path","required":true,"schema":{"type":"string","title":"Book Name"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/projects/{book_name}/chapters/{volume_num}/{chapter_num}/audio/{audio_file_name}":{"get":{"tags":["Projects & Files API"],"summary":"Get Chapter Audio File","description":"Отдает конкретный аудиофайл из главы для стриминга.","operationId":"get_chapter_audio_file_api_v1_projects__book_name__chapters__volume_num___chapter_num__audio__audio_file_name__get","parameters":[{"name":"book_name","in":"path","required":true,"schema":{"type":"string","title":"Book Name"}},{"name":"volume_num","in":"path","required":true,"schema":{"type":"integer","title":"Volume Num"}},{"name":"chapter_num","in":"path","required":true,"schema":{"type":"integer","title":"Chapter Num"}},{"name":"audio_file_name","in":"path","required":true,"schema":{"type":"string","title":"Audio File Name"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/voices":{"get":{"tags":["Asset Library"],"summary":"Get Voices Library","description":"Возвращает список всех доступных голосов.","operationId":"get_voices_library_api_v1_voices_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}},"post":{"tags":["Asset Library"],"summary":"Upload Voice","description":"Загружает новый голос в библиотеку.","operationId":"upload_voice_api_v1_voices_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_voice_api_v1_voices_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/voices/{voice_id}":{"delete":{"tags":["Asset Library"],"summary":"Delete Voice","description":"Удаляет голос из библиотеки.","operationId":"delete_voice_api_v1_voices__voice_id__delete","parameters":[{"name":"voice_id","in":"path","required":true,"schema":{"type":"string","title":"Voice Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/ambient":{"get":{"tags":["Asset Library"],"summary":"Get Ambient Library","description":"Возвращает список фоновых звуков из ambient_library.json,\nпроверяя наличие соответствующих аудиофайлов.","operationId":"get_ambient_library_api_v1_ambient_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}},"post":{"tags":["Asset Library"],"summary":"Upload Ambient","description":"Загружает новый фоновый звук: аудиофайл + метаданные в ambient_library.json.","operationId":"upload_ambient_api_v1_ambient_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_ambient_api_v1_ambient_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/ambient/{ambient_id}":{"delete":{"tags":["Asset Library"],"summary":"Delete Ambient","description":"Удаляет эмбиент из библиотеки (запись в JSON и соответствующий аудиофайл).","operationId":"delete_ambient_api_v1_ambient__ambient_id__delete","parameters":[{"name":"ambient_id","in":"path","required":true,"schema":{"type":"string","title":"Ambient Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/analyze_characters":{"post":{"tags":["AI Tasks"],"summary":"Start Character Analysis","description":"Запускает фоновую задачу для анализа персонажей во всей книге.","operationId":"start_character_analysis_api_v1_analyze_characters_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BookTaskRequest"}}},"required":true},"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/generate_summaries":{"post":{"tags":["AI Tasks"],"summary":"Start Summary Generation","description":"Запускает фоновую задачу для генерации пересказа для всех глав книги.","operationId":"start_summary_generation_api_v1_generate_summaries_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BookTaskRequest"}}},"required":true},"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/generate_scenario":{"post":{"tags":["AI Tasks"],"summary":"Start Scenario Generation","description":"Запускает фоновую задачу для генерации сценария для одной главы.","operationId":"start_scenario_generation_api_v1_generate_scenario_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterTaskRequest"}}},"required":true},"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/synthesize_tts":{"post":{"tags":["AI Tasks"],"summary":"Start Tts Synthesis","description":"Запускает фоновую задачу для синтеза речи (TTS) для одной главы.","operationId":"start_tts_synthesis_api_v1_synthesize_tts_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterTaskRequest"}}},"required":true},"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/apply_voice_conversion":{"post":{"tags":["AI Tasks"],"summary":"Start Voice Conversion","description":"Запускает фоновую задачу для применения эмоциональной окраски (VC) для одной главы.","operationId":"start_voice_conversion_api_v1_apply_voice_conversion_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterTaskRequest"}}},"required":true},"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"Body_import_project_api_v1_projects_import_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["file"],"title":"Body_import_project_api_v1_projects_import_post"},"Body_upload_ambient_api_v1_ambient_post":{"properties":{"metadata":{"type":"string","title":"Metadata","description":"JSON-строка с метаданными: {'id': '...', 'description': '...', 'tags': [...] }"},"file":{"type":"string","format":"binary","title":"File","description":"Аудиофайл (mp3, wav, ogg)."}},"type":"object","required":["metadata","file"],"title":"Body_upload_ambient_api_v1_ambient_post"},"Body_upload_cover_api_v1_projects__book_name__cover_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["file"],"title":"Body_upload_cover_api_v1_projects__book_name__cover_post"},"Body_upload_voice_api_v1_voices_post":{"properties":{"voice_id":{"type":"string","title":"Voice Id","description":"Уникальный ID для голоса, например, 'author_male'"},"file":{"type":"string","format":"binary","title":"File","description":"WAV файл с образцом голоса."}},"type":"object","required":["voice_id","file"],"title":"Body_upload_voice_api_v1_voices_post"},"BookArtifactName":{"type":"string","enum":["manifest","character_archive","summary_archive"],"title":"BookArtifactName"},"BookTaskRequest":{"properties":{"book_name":{"type":"string","title":"Book Name"}},"type":"object","required":["book_name"],"title":"BookTaskRequest"},"ChapterArtifactName":{"type":"string","enum":["scenario","subtitles"],"title":"ChapterArtifactName"},"ChapterTaskRequest":{"properties":{"book_name":{"type":"string","title":"Book Name"},"volume_num":{"type":"integer","title":"Volume Num"},"chapter_num":{"type":"integer","title":"Chapter Num"}},"type":"object","required":["book_name","volume_num","chapter_num"],"title":"ChapterTaskRequest"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"ServerStateEnum":{"type":"string","enum":["INITIALIZING","READY","ERROR"],"title":"ServerStateEnum"},"ServerStatus":{"properties":{"status":{"$ref":"#/components/schemas/ServerStateEnum"},"message":{"type":"string","title":"Message","default":""}},"type":"object","required":["status"],"title":"ServerStatus"},"TaskStatusResponse":{"properties":{"task_id":{"type":"string","title":"Task Id"},"status":{"type":"string","enum":["queued","processing","complete","failed"],"title":"Status"},"progress":{"type":"number","title":"Progress"},"stage":{"type":"string","title":"Stage"},"message":{"type":"string","title":"Message"}},"type":"object","required":["task_id","status","progress","stage","message"],"title":"TaskStatusResponse"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}