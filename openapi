{"openapi":"3.1.0","info":{"title":"BookWeaver AI Backend","description":"Локальный сервер для выполнения тяжелых AI-задач.","version":"1.0.0"},"paths":{"/health":{"get":{"tags":["Health Check"],"summary":"Health Check","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServerStatus"}}}}}}},"/api/v1/tasks/{task_id}/status":{"get":{"tags":["Task Management"],"summary":"Get Task Status","operationId":"get_task_status_api_v1_tasks__task_id__status_get","parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"string","title":"Task Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/analyze_characters":{"post":{"tags":["AI Tasks"],"summary":"Start Character Analysis","operationId":"start_character_analysis_api_v1_analyze_characters_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BookTaskRequest"}}},"required":true},"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/generate_summaries":{"post":{"tags":["AI Tasks"],"summary":"Start Summary Generation","operationId":"start_summary_generation_api_v1_generate_summaries_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BookTaskRequest"}}},"required":true},"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/generate_scenario":{"post":{"tags":["AI Tasks"],"summary":"Start Scenario Generation","operationId":"start_scenario_generation_api_v1_generate_scenario_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterTaskRequest"}}},"required":true},"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/synthesize_tts":{"post":{"tags":["AI Tasks"],"summary":"Start Tts Synthesis","operationId":"start_tts_synthesis_api_v1_synthesize_tts_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterTaskRequest"}}},"required":true},"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/apply_voice_conversion":{"post":{"tags":["AI Tasks"],"summary":"Start Voice Conversion","operationId":"start_voice_conversion_api_v1_apply_voice_conversion_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterTaskRequest"}}},"required":true},"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/projects/import":{"post":{"tags":["Projects & Files API"],"summary":"Import Project","description":"NEW: Загружает файл книги (.txt, .epub) и преобразует его в структуру проекта.","operationId":"import_project_api_v1_projects_import_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_import_project_api_v1_projects_import_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/projects":{"get":{"tags":["Projects & Files API"],"summary":"List Projects","description":"Сканирует директорию input/books и возвращает список всех книг (проектов).","operationId":"list_projects_api_v1_projects_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"type":"string"},"type":"array","title":"Response List Projects Api V1 Projects Get"}}}}}}},"/api/v1/projects/{book_name}":{"get":{"tags":["Projects & Files API"],"summary":"Get Project Details","description":"Возвращает детальную информацию о книге: список глав и статус их обработки.","operationId":"get_project_details_api_v1_projects__book_name__get","parameters":[{"name":"book_name","in":"path","required":true,"schema":{"type":"string","title":"Book Name"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectDetailsResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/projects/{book_name}/artifacts/{artifact_name}":{"get":{"tags":["Projects & Files API"],"summary":"Get Book Artifact","description":"Возвращает содержимое артефакта уровня книги (например, manifest.json).","operationId":"get_book_artifact_api_v1_projects__book_name__artifacts__artifact_name__get","parameters":[{"name":"book_name","in":"path","required":true,"schema":{"type":"string","title":"Book Name"}},{"name":"artifact_name","in":"path","required":true,"schema":{"$ref":"#/components/schemas/BookArtifactName"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Projects & Files API"],"summary":"Update Book Artifact","description":"Обновляет (перезаписывает) артефакт уровня книги (например, manifest.json).\nПринимает JSON в теле запроса.","operationId":"update_book_artifact_api_v1_projects__book_name__artifacts__artifact_name__post","parameters":[{"name":"book_name","in":"path","required":true,"schema":{"type":"string","title":"Book Name"}},{"name":"artifact_name","in":"path","required":true,"schema":{"$ref":"#/components/schemas/BookArtifactName"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/projects/{book_name}/chapters/{volume_num}/{chapter_num}/artifacts/{artifact_name}":{"get":{"tags":["Projects & Files API"],"summary":"Get Chapter Artifact","description":"Возвращает содержимое артефакта уровня главы (например, scenario.json).","operationId":"get_chapter_artifact_api_v1_projects__book_name__chapters__volume_num___chapter_num__artifacts__artifact_name__get","parameters":[{"name":"book_name","in":"path","required":true,"schema":{"type":"string","title":"Book Name"}},{"name":"volume_num","in":"path","required":true,"schema":{"type":"integer","title":"Volume Num"}},{"name":"chapter_num","in":"path","required":true,"schema":{"type":"integer","title":"Chapter Num"}},{"name":"artifact_name","in":"path","required":true,"schema":{"$ref":"#/components/schemas/ChapterArtifactName"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"Body_import_project_api_v1_projects_import_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["file"],"title":"Body_import_project_api_v1_projects_import_post"},"BookArtifactName":{"type":"string","enum":["manifest","character_archive","summary_archive"],"title":"BookArtifactName"},"BookTaskRequest":{"properties":{"book_name":{"type":"string","title":"Book Name"}},"type":"object","required":["book_name"],"title":"BookTaskRequest"},"ChapterArtifactName":{"type":"string","enum":["scenario","subtitles"],"title":"ChapterArtifactName"},"ChapterStatus":{"properties":{"volume_num":{"type":"integer","title":"Volume Num"},"chapter_num":{"type":"integer","title":"Chapter Num"},"has_scenario":{"type":"boolean","title":"Has Scenario"},"has_subtitles":{"type":"boolean","title":"Has Subtitles"},"has_audio":{"type":"boolean","title":"Has Audio"}},"type":"object","required":["volume_num","chapter_num","has_scenario","has_subtitles","has_audio"],"title":"ChapterStatus"},"ChapterTaskRequest":{"properties":{"book_name":{"type":"string","title":"Book Name"},"volume_num":{"type":"integer","title":"Volume Num"},"chapter_num":{"type":"integer","title":"Chapter Num"}},"type":"object","required":["book_name","volume_num","chapter_num"],"title":"ChapterTaskRequest"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"ProjectDetailsResponse":{"properties":{"book_name":{"type":"string","title":"Book Name"},"chapters":{"items":{"$ref":"#/components/schemas/ChapterStatus"},"type":"array","title":"Chapters"}},"type":"object","required":["book_name","chapters"],"title":"ProjectDetailsResponse"},"ServerStateEnum":{"type":"string","enum":["INITIALIZING","READY","ERROR"],"title":"ServerStateEnum"},"ServerStatus":{"properties":{"status":{"$ref":"#/components/schemas/ServerStateEnum"},"message":{"type":"string","title":"Message","default":""}},"type":"object","required":["status"],"title":"ServerStatus"},"TaskStatusResponse":{"properties":{"task_id":{"type":"string","title":"Task Id"},"status":{"type":"string","enum":["queued","processing","complete","failed"],"title":"Status"},"progress":{"type":"number","title":"Progress"},"message":{"type":"string","title":"Message"}},"type":"object","required":["task_id","status","progress","message"],"title":"TaskStatusResponse"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}